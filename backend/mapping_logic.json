{
  "version": "2.0",
  "description": "Única fonte de verdade para traduzir achados técnicos em controles ISO 27001. Cobre 15 domínios do Anexo A para spider chart completo.",
  "mappings": [
    {
      "technical_finding": "open_rdp_port",
      "template_id": null,
      "port": 3389,
      "control_id": "C-01",
      "iso_domain": "A.13.1.1",
      "iso_title": "Redes - Controle de acesso a serviços",
      "score_deduction": 400,
      "severity": "critical",
      "recommendation": "Restringir porta 3389 ou usar VPN. Nunca expor RDP diretamente à internet."
    },
    {
      "technical_finding": "open_smb_port",
      "template_id": null,
      "port": 445,
      "control_id": "C-01",
      "iso_domain": "A.13.1.1",
      "iso_title": "Redes - Controle de acesso a serviços",
      "score_deduction": 400,
      "severity": "critical",
      "recommendation": "Bloquear porta 445 para internet. SMB não deve ser acessível externamente."
    },
    {
      "technical_finding": "open_database_port_mysql",
      "template_id": null,
      "port": 3306,
      "control_id": "C-01",
      "iso_domain": "A.13.1.1",
      "iso_title": "Redes - Controle de acesso a serviços",
      "score_deduction": 350,
      "severity": "critical",
      "recommendation": "Restringir acesso ao MySQL (3306) via firewall. Usar conexões privadas."
    },
    {
      "technical_finding": "open_database_port_postgres",
      "template_id": null,
      "port": 5432,
      "control_id": "C-01",
      "iso_domain": "A.13.1.1",
      "iso_title": "Redes - Controle de acesso a serviços",
      "score_deduction": 350,
      "severity": "critical",
      "recommendation": "Restringir acesso ao PostgreSQL (5432) via firewall."
    },
    {
      "technical_finding": "open_database_port_mongo",
      "template_id": null,
      "port": 27017,
      "control_id": "C-01",
      "iso_domain": "A.13.1.1",
      "iso_title": "Redes - Controle de acesso a serviços",
      "score_deduction": 350,
      "severity": "critical",
      "recommendation": "Restringir acesso ao MongoDB (27017). Nunca expor sem autenticação."
    },
    {
      "technical_finding": "expired_ssl",
      "template_id": "ssl-expired-cert",
      "port": null,
      "control_id": "C-02",
      "iso_domain": "A.10.1.1",
      "iso_title": "Criptografia - Certificados digitais",
      "score_deduction": 200,
      "severity": "high",
      "recommendation": "Renovar certificado SSL imediatamente."
    },
    {
      "technical_finding": "ssl_expires_soon",
      "template_id": null,
      "port": null,
      "control_id": "C-02",
      "iso_domain": "A.10.1.1",
      "iso_title": "Criptografia - Certificados digitais",
      "score_deduction": 80,
      "severity": "medium",
      "recommendation": "Planejar renovação do certificado antes da expiração."
    },
    {
      "technical_finding": "weak_tls",
      "template_id": "ssl-tls-version",
      "port": null,
      "control_id": "C-02",
      "iso_domain": "A.10.1.1",
      "iso_title": "Criptografia - TLS",
      "score_deduction": 120,
      "severity": "high",
      "recommendation": "Desabilitar TLS 1.0/1.1. Usar TLS 1.2+ com cipher suites fortes."
    },
    {
      "technical_finding": "self_signed_cert",
      "template_id": "ssl-self-signed",
      "port": null,
      "control_id": "C-02",
      "iso_domain": "A.10.1.1",
      "iso_title": "Criptografia - Certificados digitais",
      "score_deduction": 100,
      "severity": "medium",
      "recommendation": "Substituir certificado auto-assinado por CA confiável."
    },
    {
      "technical_finding": "outdated_software",
      "template_id": null,
      "port": null,
      "control_id": "C-03",
      "iso_domain": "A.12.6.1",
      "iso_title": "Vulnerabilidades - Patch management",
      "score_deduction": 80,
      "severity": "medium",
      "recommendation": "Aplicar patches de segurança conforme processo de gestão de vulnerabilidades."
    },
    {
      "technical_finding": "known_cve",
      "template_id": "cve-*",
      "port": null,
      "control_id": "C-03",
      "iso_domain": "A.12.6.1",
      "iso_title": "Vulnerabilidades - CVE conhecida",
      "score_deduction": 150,
      "severity": "high",
      "recommendation": "Aplicar patch para a CVE identificada. Consultar NVD para detalhes."
    },
    {
      "technical_finding": "critical_cve",
      "template_id": null,
      "port": null,
      "control_id": "C-03",
      "iso_domain": "A.12.6.1",
      "iso_title": "Vulnerabilidades - CVE crítica (CVSS >= 9.0)",
      "score_deduction": 350,
      "severity": "critical",
      "recommendation": "CVE crítica com CVSS >= 9.0. Aplicar patch emergencialmente."
    },
    {
      "technical_finding": "subdomain_exposure",
      "template_id": null,
      "port": null,
      "control_id": "C-03",
      "iso_domain": "A.12.6.1",
      "iso_title": "Descoberta de ativos - Subdomínios expostos",
      "score_deduction": 20,
      "severity": "low",
      "recommendation": "Revisar subdomínios expostos e desativar os não utilizados."
    },
    {
      "technical_finding": "nuclei_generic",
      "template_id": "*",
      "port": null,
      "control_id": "C-03",
      "iso_domain": "A.12.6.1",
      "iso_title": "Vulnerabilidades - Achado genérico Nuclei",
      "score_deduction": 80,
      "severity": "medium",
      "recommendation": "Corrigir vulnerabilidade identificada pelo scanner."
    },
    {
      "technical_finding": "missing_dmarc",
      "template_id": null,
      "port": null,
      "control_id": "C-04",
      "iso_domain": "A.13.2.1",
      "iso_title": "Comunicações - Anti-phishing (DMARC)",
      "score_deduction": 150,
      "severity": "high",
      "recommendation": "Implementar DMARC com política p=reject ou p=quarantine."
    },
    {
      "technical_finding": "dmarc_none",
      "template_id": null,
      "port": null,
      "control_id": "C-04",
      "iso_domain": "A.13.2.1",
      "iso_title": "Comunicações - DMARC em modo permissivo",
      "score_deduction": 100,
      "severity": "high",
      "recommendation": "Alterar política DMARC de p=none para p=quarantine ou p=reject."
    },
    {
      "technical_finding": "missing_spf",
      "template_id": null,
      "port": null,
      "control_id": "C-04",
      "iso_domain": "A.13.2.1",
      "iso_title": "Comunicações - SPF ausente",
      "score_deduction": 120,
      "severity": "high",
      "recommendation": "Implementar registro SPF para prevenir spoofing de e-mail."
    },
    {
      "technical_finding": "missing_dkim",
      "template_id": null,
      "port": null,
      "control_id": "C-04",
      "iso_domain": "A.13.2.1",
      "iso_title": "Comunicações - DKIM ausente",
      "score_deduction": 80,
      "severity": "medium",
      "recommendation": "Configurar DKIM para autenticação de e-mails enviados."
    },
    {
      "technical_finding": "open_ssh_port",
      "template_id": null,
      "port": 22,
      "control_id": "C-05",
      "iso_domain": "A.9.4.1",
      "iso_title": "Controle de acesso - SSH exposto",
      "score_deduction": 60,
      "severity": "medium",
      "recommendation": "Restringir SSH via firewall ou bastion host. Desabilitar autenticação por senha."
    },
    {
      "technical_finding": "open_telnet_port",
      "template_id": null,
      "port": 23,
      "control_id": "C-05",
      "iso_domain": "A.9.4.1",
      "iso_title": "Controle de acesso - Telnet (texto claro)",
      "score_deduction": 300,
      "severity": "critical",
      "recommendation": "Desabilitar Telnet. Usar SSH para acesso remoto seguro."
    },
    {
      "technical_finding": "open_ftp_port",
      "template_id": null,
      "port": 21,
      "control_id": "C-05",
      "iso_domain": "A.9.4.1",
      "iso_title": "Controle de acesso - FTP (texto claro)",
      "score_deduction": 150,
      "severity": "high",
      "recommendation": "Desabilitar FTP. Usar SFTP ou SCP para transferência segura."
    },
    {
      "technical_finding": "missing_hsts",
      "template_id": "http-missing-security-headers",
      "port": null,
      "control_id": "C-06",
      "iso_domain": "A.12.4.1",
      "iso_title": "Segurança operacional - Header HSTS ausente",
      "score_deduction": 50,
      "severity": "medium",
      "recommendation": "Configurar Strict-Transport-Security com max-age adequado."
    },
    {
      "technical_finding": "missing_csp",
      "template_id": null,
      "port": null,
      "control_id": "C-06",
      "iso_domain": "A.12.4.1",
      "iso_title": "Segurança operacional - Header CSP ausente",
      "score_deduction": 50,
      "severity": "medium",
      "recommendation": "Implementar Content-Security-Policy para prevenir XSS."
    },
    {
      "technical_finding": "missing_x_frame_options",
      "template_id": null,
      "port": null,
      "control_id": "C-06",
      "iso_domain": "A.12.4.1",
      "iso_title": "Segurança operacional - X-Frame-Options ausente",
      "score_deduction": 40,
      "severity": "medium",
      "recommendation": "Configurar X-Frame-Options: DENY ou SAMEORIGIN para prevenir clickjacking."
    },
    {
      "technical_finding": "server_version_exposed",
      "template_id": null,
      "port": null,
      "control_id": "C-06",
      "iso_domain": "A.12.4.1",
      "iso_title": "Segurança operacional - Versão de servidor exposta",
      "score_deduction": 20,
      "severity": "low",
      "recommendation": "Remover ou ocultar banners de versão de servidor (Server, X-Powered-By)."
    },
    {
      "technical_finding": "leaked_credentials",
      "template_id": null,
      "port": null,
      "control_id": "C-10",
      "iso_domain": "A.16.1.1",
      "iso_title": "Resposta a incidentes - Credenciais vazadas",
      "score_deduction": 400,
      "severity": "critical",
      "recommendation": "Revogar credenciais vazadas imediatamente. Investigar extensão do vazamento."
    },
    {
      "technical_finding": "exposed_admin_panel",
      "template_id": "exposed-panels-*",
      "port": null,
      "control_id": "C-13",
      "iso_domain": "A.14.2.1",
      "iso_title": "Desenvolvimento seguro - Painel admin exposto",
      "score_deduction": 120,
      "severity": "high",
      "recommendation": "Restringir acesso ao painel administrativo via VPN ou whitelist de IP."
    },
    {
      "technical_finding": "directory_listing",
      "template_id": null,
      "port": null,
      "control_id": "C-13",
      "iso_domain": "A.14.2.1",
      "iso_title": "Desenvolvimento seguro - Directory listing habilitado",
      "score_deduction": 80,
      "severity": "medium",
      "recommendation": "Desabilitar directory listing no servidor web."
    },
    {
      "technical_finding": "information_disclosure",
      "template_id": null,
      "port": null,
      "control_id": "C-13",
      "iso_domain": "A.14.2.1",
      "iso_title": "Desenvolvimento seguro - Information disclosure",
      "score_deduction": 60,
      "severity": "medium",
      "recommendation": "Corrigir vazamento de informações sensíveis (stack traces, config, etc.)."
    },
    {
      "technical_finding": "missing_privacy_policy",
      "template_id": null,
      "port": null,
      "control_id": "C-14",
      "iso_domain": "A.18.1.1",
      "iso_title": "Compliance - Política de privacidade ausente",
      "score_deduction": 80,
      "severity": "medium",
      "recommendation": "Publicar política de privacidade conforme LGPD Art. 9°."
    },
    {
      "technical_finding": "cookies_without_consent",
      "template_id": null,
      "port": null,
      "control_id": "C-14",
      "iso_domain": "A.18.1.4",
      "iso_title": "Compliance - Cookies sem consentimento",
      "score_deduction": 60,
      "severity": "medium",
      "recommendation": "Implementar banner de consentimento de cookies conforme LGPD."
    }
  ],
  "port_map": {
    "21": "open_ftp_port",
    "22": "open_ssh_port",
    "23": "open_telnet_port",
    "445": "open_smb_port",
    "3306": "open_database_port_mysql",
    "3389": "open_rdp_port",
    "5432": "open_database_port_postgres",
    "27017": "open_database_port_mongo"
  },
  "template_id_prefix_map": {
    "ssl-": "C-02",
    "cve-": "C-03",
    "exposed-panels-": "C-13",
    "http-missing-security-headers": "C-06"
  },
  "control_categories": {
    "C-01": {"category": "Segurança de Rede", "iso_domain": "A.13.1.1"},
    "C-02": {"category": "Criptografia", "iso_domain": "A.10.1.1"},
    "C-03": {"category": "Gestão de Vulnerabilidades", "iso_domain": "A.12.6.1"},
    "C-04": {"category": "Segurança de E-mail", "iso_domain": "A.13.2.1"},
    "C-05": {"category": "Controle de Acesso", "iso_domain": "A.9.4.1"},
    "C-06": {"category": "Monitoramento", "iso_domain": "A.12.4.1"},
    "C-07": {"category": "Backup e Recuperação", "iso_domain": "A.12.3.1"},
    "C-08": {"category": "Políticas", "iso_domain": "A.5.1.1"},
    "C-09": {"category": "Pessoas", "iso_domain": "A.7.2.2"},
    "C-10": {"category": "Resposta a Incidentes", "iso_domain": "A.16.1.1"},
    "C-11": {"category": "Continuidade", "iso_domain": "A.17.1.1"},
    "C-12": {"category": "Fornecedores", "iso_domain": "A.15.1.1"},
    "C-13": {"category": "Desenvolvimento Seguro", "iso_domain": "A.14.2.1"},
    "C-14": {"category": "Compliance e Privacidade", "iso_domain": "A.18.1.1"},
    "C-15": {"category": "Segurança Física", "iso_domain": "A.11.1.1"}
  }
}
